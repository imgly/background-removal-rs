{
  "validation_framework_version": "1.0",
  "description": "Validation criteria and rules for background removal testing",
  "accuracy_validation": {
    "pixel_level_comparison": {
      "tolerance_levels": {
        "strict": 0,
        "normal": 5,
        "relaxed": 10
      },
      "default_tolerance": "normal",
      "comparison_method": "absolute_difference",
      "edge_detection": {
        "kernel_type": "sobel",
        "kernel_size": 3,
        "threshold": 50
      }
    },
    "structural_similarity": {
      "window_size": 11,
      "k1": 0.01,
      "k2": 0.03,
      "sigma": 1.5,
      "min_acceptable": 0.85
    },
    "perceptual_quality": {
      "lpips_threshold": 0.15,
      "psnr_min": 25.0,
      "ssim_min": 0.90
    }
  },
  "performance_validation": {
    "timing_requirements": {
      "measurement_method": "wall_clock_time",
      "warmup_iterations": 3,
      "measurement_iterations": 10,
      "statistical_method": "median",
      "timeout_seconds": 30
    },
    "memory_requirements": {
      "measurement_method": "peak_memory_usage",
      "baseline_memory_mb": 50,
      "max_memory_multiplier": 10,
      "memory_leak_detection": true
    },
    "throughput_requirements": {
      "batch_sizes": [1, 4, 8, 16],
      "parallel_processing": true,
      "queue_depth_max": 32
    }
  },
  "format_validation": {
    "input_formats": {
      "jpeg": {
        "supported_qualities": [70, 85, 95],
        "max_resolution": [4096, 4096],
        "min_resolution": [64, 64],
        "color_spaces": ["sRGB", "YCbCr"]
      },
      "png": {
        "bit_depths": [8, 16],
        "color_types": ["RGB", "RGBA", "Grayscale"],
        "compression_levels": [0, 6, 9],
        "max_resolution": [4096, 4096],
        "min_resolution": [64, 64]
      },
      "webp": {
        "lossless": true,
        "lossy": true,
        "supported_qualities": [70, 85, 95],
        "alpha_support": true,
        "max_resolution": [4096, 4096],
        "min_resolution": [64, 64]
      },
      "raw_rgb24": {
        "pixel_format": "RGB24",
        "bytes_per_pixel": 3,
        "stride_alignment": 4,
        "color_spaces": ["sRGB", "BT.709", "BT.2020"]
      },
      "raw_rgba32": {
        "pixel_format": "RGBA32",
        "bytes_per_pixel": 4,
        "stride_alignment": 4,
        "color_spaces": ["sRGB", "BT.709", "BT.2020"],
        "alpha_premultiplied": false
      },
      "raw_yuv420p": {
        "pixel_format": "YUV420P",
        "chroma_subsampling": "4:2:0",
        "plane_layout": "planar",
        "color_spaces": ["BT.601", "BT.709", "BT.2020"]
      },
      "raw_yuv444p": {
        "pixel_format": "YUV444P", 
        "chroma_subsampling": "4:4:4",
        "plane_layout": "planar",
        "color_spaces": ["BT.601", "BT.709", "BT.2020"]
      }
    },
    "output_formats": {
      "png_alpha": {
        "format": "PNG",
        "bit_depth": 8,
        "color_type": "RGBA",
        "compression_level": 6,
        "alpha_validation": {
          "alpha_range": [0, 255],
          "transparency_check": true,
          "alpha_edge_smoothness": true
        }
      },
      "jpeg_background": {
        "format": "JPEG",
        "quality": 90,
        "color_type": "RGB",
        "background_colors": {
          "white": [255, 255, 255],
          "black": [0, 0, 0],
          "custom": "configurable"
        }
      },
      "webp_alpha": {
        "format": "WebP",
        "quality": 85,
        "lossless": false,
        "alpha_support": true,
        "alpha_validation": {
          "alpha_range": [0, 255],
          "transparency_check": true
        }
      },
      "mask_grayscale": {
        "format": "PNG",
        "bit_depth": 8,
        "color_type": "Grayscale",
        "value_range": [0, 255],
        "validation": {
          "binary_mask": false,
          "soft_edges": true,
          "gradient_smoothness": true
        }
      }
    }
  },
  "compatibility_validation": {
    "javascript_reference": {
      "comparison_method": "pixel_by_pixel",
      "tolerance": 5,
      "ignore_compression_artifacts": true,
      "structural_similarity_threshold": 0.95
    },
    "cross_platform": {
      "platforms": ["macOS-x64", "macOS-arm64", "linux-x64", "linux-arm64"],
      "deterministic_output": true,
      "floating_point_tolerance": 1e-6
    },
    "model_versions": {
      "isnet_standard": {
        "model_file": "isnet.onnx",
        "expected_accuracy": 0.95,
        "performance_baseline": 1.0
      },
      "isnet_fp16": {
        "model_file": "isnet_fp16.onnx", 
        "expected_accuracy": 0.92,
        "performance_baseline": 1.8
      }
    }
  },
  "error_handling_validation": {
    "invalid_inputs": {
      "corrupted_images": {
        "test_types": ["truncated", "invalid_header", "corrupted_data"],
        "expected_behavior": "graceful_error"
      },
      "unsupported_formats": {
        "formats": ["TIFF", "BMP", "GIF"],
        "expected_behavior": "clear_error_message"
      },
      "extreme_resolutions": {
        "too_small": [32, 32],
        "too_large": [8192, 8192],
        "expected_behavior": "dimension_validation"
      }
    },
    "resource_constraints": {
      "memory_exhaustion": {
        "test_method": "large_batch_processing",
        "expected_behavior": "graceful_degradation"
      },
      "timeout_handling": {
        "max_processing_time": 30,
        "expected_behavior": "timeout_error"
      }
    }
  },
  "regression_testing": {
    "reference_outputs": {
      "storage_method": "git_lfs",
      "hash_verification": true,
      "compression": "lossless"
    },
    "performance_regression": {
      "baseline_tolerance": 0.10,
      "measurement_stability": 0.05,
      "trend_analysis": true
    },
    "accuracy_regression": {
      "pixel_accuracy_tolerance": 0.02,
      "structural_similarity_tolerance": 0.01,
      "perceptual_quality_tolerance": 0.05
    }
  },
  "continuous_integration": {
    "automated_testing": {
      "trigger_events": ["push", "pull_request"],
      "test_matrix": {
        "platforms": ["ubuntu-latest", "macos-latest"],
        "architectures": ["x64", "arm64"],
        "model_versions": ["standard", "fp16"]
      }
    },
    "performance_monitoring": {
      "benchmark_frequency": "daily",
      "performance_alerts": true,
      "regression_threshold": 0.15
    },
    "test_data_management": {
      "version_control": true,
      "data_integrity_checks": true,
      "automated_updates": false
    }
  }
}